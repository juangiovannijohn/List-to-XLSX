<div class="container max-w-2xl mx-auto py-7">
  <p class="text-5xl text-violet-700">List to Excel</p>
  <p class="">
    Sube un Archivo XLSX con los IDs de los usuarios que quieras obtener toda su
    información
  </p>
  <a href="https://github.com/juangiovannijohn/List-to-XLSX" target="_blank" class=" inline-block cursor-pointer my-1 py-3 px-5 rounded-full border-0 text-sm font-semibold bg-violet-700 text-violet-50 font-semibold hover:text-violet-700 hover:bg-violet-200">Ver repositorio</a>
 

  <section class="w-full bg-[#424242] p-5 border-b-2 border-slate-400/50">
    <div class="block w-full">
      <p class="text-xl pl-1.5 text-slate-100">Subir Archivo</p>
      <span class="sr-only">Subir un archivo Excel</span>
      <input
        type="file"
        (change)="onChangeRead($event)"
        class="block w-full mb-2 text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-50 file:text-violet-700 hover:file:bg-violet-100"
        accept=".xlsx, .cvs, .lsx"
      />
      <p class="italic text-slate-100 pl-1.5">
        El encabezado de la primer columna se debe llamar "ID"
      </p>
      <button
        class="my-4 py-2 px-4 rounded-full border-0 text-sm font-semibold bg-violet-700 text-violet-50 font-semibold hover:text-violet-700 hover:bg-violet-200"
        (click)="fileUpload()"
      >
        Procesar
      </button>
    </div>
  </section>

  <table mat-table [dataSource]="dataSource" class="mb-4 demo-table">
    <!-- Name Column -->
    <ng-container matColumnDef="id">
      <th mat-header-cell *matHeaderCellDef>Id</th>
      <td mat-cell *matCellDef="let element">{{ element.id }}</td>
    </ng-container>
    <!-- Name Column -->
    <ng-container matColumnDef="Nombre">
      <th mat-header-cell *matHeaderCellDef>Nombre</th>
      <td mat-cell *matCellDef="let element">{{ element.name }}</td>
    </ng-container>

    <!-- Company Column -->
    <ng-container matColumnDef="Empresa">
      <th mat-header-cell *matHeaderCellDef>Empresa</th>
      <td mat-cell *matCellDef="let element">{{ element.company.name }}</td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>
  <div>
    <p class="text-2xl text-violet-500">Notas sobre la app:</p>
    <p>
      Éstos usuarios provienen de una API pública. Al iniciar la app se hace una
      consulta al endpoint de usuarios, se obtiene el objeto JSON y se muestra
      en pantalla con la tabla.
    </p>
    <p>
      Al cargarse el archivo Excel, el proceso de la app es leer los IDs y luego
      hacer una petición por cada usuario al endpoint. Se realiza un proceso de
      refactorización de la información que proviene de la API, y luego se lo
      agrega dentro en un nuevo archivo Excel el cual se descarga
      automaticamente.
    </p>
  </div>
  <div class="">
    <p class="text-xl text-violet-500">Gracias: JSON Placeholder API</p>
    <p>[GET] https://jsonplaceholder.typicode.com/users</p>
    <a href="https://github.com/juangiovannijohn/List-to-XLSX" target="_blank" class="inline-block cursor-pointer mt-1.5 py-3 px-5 rounded-full border-0 text-sm font-semibold bg-violet-700 text-violet-50 font-semibold hover:text-violet-700 hover:bg-violet-200">Ver repositorio</a>
  </div>
</div>
